
\section{Gumbel-softmax distribution}

The Gumbel softmax distribution 

The softmax function can be used to parameterized a multi-nomial distribution
on a one-hot-encoding $d$-dimensional vectors $\mathbf{y}$ in terms of a
continuous $d$-dimensional vector $\mathbf{x}$. Let $\mathbf{p}$ be a $d$-dimensional vector of probabilities
specifying the multi-nomial distribution on $\mathbf{y}$ with $p_i = p(y_i=1)$. Then
\begin{align}
\mathbf{p} = \text{softmax}(\mathbf{x})\,\label{sec:gumbel:eq:0}
\end{align}
where $\text{softmax}(\cdot)$ returns here a $d$-dimensional vector with the output of the softmax function:
\begin{align}
\left[\text{softmax}(\mathbf{x})\right]_i = \frac{\exp(\mathbf{x}_i)}{\sum_{j=1}^K\exp(\mathbf{x}_j)}\,,\quad\text{for}\quad i = 1,\ldots,d\,.
\end{align}
It can be shown that sampling $\mathbf{y}$ according to the previous multinomial distribution with probability vector 
given by (\ref{sec:gumbel:eq:0}) is the same as sampling $\mathbf{y}$ according to
\begin{align}
\mathbf{y} = \text{one\_hot}(\underset{i}{\arg\max} (x_i + z_i))\,,\label{sec:gumbel:eq:1}
\end{align}
where the $z_i$ are independent and follow a Gumbel distribution with zero location and unit scale.

The sample generated in (\ref{sec:gumbel:eq:1}) has gradient zero with respect to
$\mathbf{x}$ because the $\text{one\_hot}(\arg\max(\cdot))$
operator is not differentiable.
We propose to approximate this operator with a differentiable function based on the soft-max transformation.
In particular, we approximate $\mathbf{y}$ with 
\begin{align}
\mathbf{y} = \text{softmax}(1 / \tau (\mathbf{x} + \mathbf{z})))\,,\label{sec:gumbel:eq:2}
\end{align}
where $\tau$ is an inverse temperature parameter. When $\tau \rightarrow 0$ the samples generated by (\ref{sec:gumbel:eq:2})
have the same distribution as those generated by (\ref{sec:gumbel:eq:1}). When $\tau \rightarrow \infty$
the samples generated by (\ref{sec:gumbel:eq:2}) are always the uniform probability vector. For positive and finite values
of $\tau$ the samples generated by (\ref{sec:gumbel:eq:2}) are smooth and differentiable with respect to $\mathbf{x}$.






